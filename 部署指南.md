# ERP ç®¡ç†å¹³å° - ç½‘ç»œéƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—æä¾›å¤šç§æ–¹å¼å°† ERP å¹³å°éƒ¨ç½²åˆ°ç½‘ç»œä¸Šï¼Œè®©å­¦ç”Ÿå¯ä»¥é€šè¿‡äº’è”ç½‘è®¿é—®ã€‚

---

## ğŸ“‹ éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | éš¾åº¦ | æˆæœ¬ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **æ–¹æ¡ˆä¸€ï¼šå…è´¹äº‘å¹³å°ï¼ˆRender/Railwayï¼‰** | â­ ç®€å• | å…è´¹ | å¿«é€Ÿéƒ¨ç½²ï¼Œé€‚åˆæ•™å­¦ |
| **æ–¹æ¡ˆäºŒï¼šäº‘æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰** | â­â­ ä¸­ç­‰ | ä½ï¼ˆå­¦ç”Ÿä¼˜æƒ ï¼‰ | éœ€è¦æ›´å¤šæ§åˆ¶æƒ |
| **æ–¹æ¡ˆä¸‰ï¼šDocker å®¹å™¨åŒ–** | â­â­ ä¸­ç­‰ | æŒ‰å¹³å° | æ ‡å‡†åŒ–éƒ¨ç½² |
| **æ–¹æ¡ˆå››ï¼šå­¦æ ¡å†…ç½‘æœåŠ¡å™¨** | â­â­â­ è¾ƒéš¾ | å…è´¹ | ä»…é™æ ¡å†…è®¿é—® |

---

## ğŸš€ æ–¹æ¡ˆä¸€ï¼šå…è´¹äº‘å¹³å°éƒ¨ç½²ï¼ˆæ¨èï¼‰

### 1.1 Renderï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰

**ä¼˜ç‚¹**ï¼šå…è´¹ã€è‡ªåŠ¨éƒ¨ç½²ã€æ”¯æŒ HTTPS

#### æ­¥éª¤ï¼š

1. **æ³¨å†Œè´¦å·**
   - è®¿é—®ï¼šhttps://render.com
   - ä½¿ç”¨ GitHub è´¦å·ç™»å½•ï¼ˆæ¨èï¼‰

2. **å‡†å¤‡ä»£ç **
   - å°†é¡¹ç›®ä¸Šä¼ åˆ° GitHubï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
   - ç¡®ä¿é¡¹ç›®æ ¹ç›®å½•æœ‰ `wsgi.py` å’Œ `requirements.txt`

3. **åˆ›å»º Web Service**
   - ç‚¹å‡» "New +" â†’ "Web Service"
   - è¿æ¥ä½ çš„ GitHub ä»“åº“
   - é…ç½®ï¼š
     - **Name**: `erp-platform`
     - **Environment**: `Python 3`
     - **Build Command**: `pip install -r erp_platform/requirements.txt`
     - **Start Command**: `gunicorn -c gunicorn_config.py wsgi:app`
     - **Instance Type**: Freeï¼ˆå…è´¹ï¼‰

4. **ç¯å¢ƒå˜é‡**ï¼ˆå¯é€‰ï¼‰
   - `PORT`: 8000ï¼ˆRender ä¼šè‡ªåŠ¨è®¾ç½®ï¼‰
   - `SECRET_KEY`: è®¾ç½®ä¸€ä¸ªéšæœºå¯†é’¥

5. **éƒ¨ç½²**
   - ç‚¹å‡» "Create Web Service"
   - ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆçº¦ 5-10 åˆ†é’Ÿï¼‰
   - è·å¾— URLï¼š`https://your-app.onrender.com`

**è®¿é—®åœ°å€**ï¼šéƒ¨ç½²å®Œæˆåä¼šå¾—åˆ°ä¸€ä¸ª `https://xxx.onrender.com` çš„åœ°å€ï¼Œå­¦ç”Ÿå¯ä»¥ç›´æ¥è®¿é—®ã€‚

---

### 1.2 Railwayï¼ˆå¤‡é€‰ï¼‰

**æ­¥éª¤ç±»ä¼¼ Render**ï¼š
1. è®¿é—®ï¼šhttps://railway.app
2. ä½¿ç”¨ GitHub ç™»å½•
3. åˆ›å»ºæ–°é¡¹ç›®ï¼Œè¿æ¥ä»“åº“
4. Railway ä¼šè‡ªåŠ¨æ£€æµ‹ Python é¡¹ç›®å¹¶éƒ¨ç½²
5. è·å¾— URLï¼š`https://xxx.up.railway.app`

---

## ğŸ–¥ï¸ æ–¹æ¡ˆäºŒï¼šäº‘æœåŠ¡å™¨éƒ¨ç½²

### 2.1 è´­ä¹°äº‘æœåŠ¡å™¨

**æ¨èå¹³å°**ï¼š
- **é˜¿é‡Œäº‘**ï¼šhttps://www.aliyun.comï¼ˆå­¦ç”Ÿä¼˜æƒ çº¦ 10 å…ƒ/æœˆï¼‰
- **è…¾è®¯äº‘**ï¼šhttps://cloud.tencent.comï¼ˆå­¦ç”Ÿä¼˜æƒ çº¦ 10 å…ƒ/æœˆï¼‰
- **åä¸ºäº‘**ï¼šhttps://www.huaweicloud.com

**é…ç½®å»ºè®®**ï¼š
- CPU: 1æ ¸
- å†…å­˜: 2GB
- ç³»ç»Ÿ: Ubuntu 22.04 LTS
- å¸¦å®½: 1-5 Mbps

### 2.2 æœåŠ¡å™¨éƒ¨ç½²æ­¥éª¤

#### 1. è¿æ¥æœåŠ¡å™¨
```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

#### 2. å®‰è£…ä¾èµ–
```bash
# æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# å®‰è£… Python å’Œ pip
apt install python3 python3-pip python3-venv -y

# å®‰è£… Nginxï¼ˆç”¨äºåå‘ä»£ç†ï¼‰
apt install nginx -y
```

#### 3. ä¸Šä¼ ä»£ç 
```bash
# æ–¹æ³•ä¸€ï¼šä½¿ç”¨ gitï¼ˆæ¨èï¼‰
apt install git -y
cd /opt
git clone ä½ çš„GitHubä»“åº“åœ°å€
cd ç»ƒä¹ ç½‘ç«™

# æ–¹æ³•äºŒï¼šä½¿ç”¨ scpï¼ˆä»æœ¬åœ°ï¼‰
# åœ¨æœ¬åœ°ç»ˆç«¯æ‰§è¡Œï¼š
# scp -r /Users/wangxiyue/è½¯ä»¶æµ‹è¯•/ç»ƒä¹ ç½‘ç«™ root@æœåŠ¡å™¨IP:/opt/
```

#### 4. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
```bash
cd /opt/ç»ƒä¹ ç½‘ç«™
python3 -m venv venv
source venv/bin/activate
pip install -r erp_platform/requirements.txt
pip install gunicorn
```

#### 5. ä½¿ç”¨ Gunicorn å¯åŠ¨
```bash
# æµ‹è¯•å¯åŠ¨
gunicorn -c gunicorn_config.py wsgi:app

# åå°è¿è¡Œï¼ˆä½¿ç”¨ nohupï¼‰
nohup gunicorn -c gunicorn_config.py wsgi:app > app.log 2>&1 &

# æˆ–ä½¿ç”¨ systemd æœåŠ¡ï¼ˆæ¨èï¼‰
```

#### 6. é…ç½® systemd æœåŠ¡ï¼ˆæ¨èï¼‰

åˆ›å»ºæœåŠ¡æ–‡ä»¶ï¼š
```bash
sudo nano /etc/systemd/system/erp-platform.service
```

å†…å®¹ï¼š
```ini
[Unit]
Description=ERP Platform Gunicorn Service
After=network.target

[Service]
User=root
Group=root
WorkingDirectory=/opt/ç»ƒä¹ ç½‘ç«™
Environment="PATH=/opt/ç»ƒä¹ ç½‘ç«™/venv/bin"
ExecStart=/opt/ç»ƒä¹ ç½‘ç«™/venv/bin/gunicorn -c gunicorn_config.py wsgi:app
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
sudo systemctl daemon-reload
sudo systemctl enable erp-platform
sudo systemctl start erp-platform
sudo systemctl status erp-platform
```

#### 7. é…ç½® Nginx åå‘ä»£ç†

ç¼–è¾‘ Nginx é…ç½®ï¼š
```bash
sudo nano /etc/nginx/sites-available/erp-platform
```

å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name ä½ çš„åŸŸåæˆ–IP;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

å¯ç”¨é…ç½®ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/erp-platform /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

#### 8. é…ç½®é˜²ç«å¢™
```bash
# å…è®¸ HTTP
sudo ufw allow 80/tcp
sudo ufw allow 8000/tcp
sudo ufw enable
```

**è®¿é—®åœ°å€**ï¼š`http://ä½ çš„æœåŠ¡å™¨IP` æˆ– `http://ä½ çš„åŸŸå`

---

## ğŸ³ æ–¹æ¡ˆä¸‰ï¼šDocker å®¹å™¨åŒ–éƒ¨ç½²

### 3.1 æœ¬åœ°æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -t erp-platform .

# è¿è¡Œå®¹å™¨
docker run -d -p 8000:8000 --name erp erp-platform

# è®¿é—®
# http://localhost:8000
```

### 3.2 éƒ¨ç½²åˆ° Docker Hub

```bash
# ç™»å½• Docker Hub
docker login

# æ‰“æ ‡ç­¾
docker tag erp-platform ä½ çš„ç”¨æˆ·å/erp-platform

# æ¨é€
docker push ä½ çš„ç”¨æˆ·å/erp-platform
```

### 3.3 åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ

```bash
# å®‰è£… Docker
curl -fsSL https://get.docker.com | sh

# æ‹‰å–é•œåƒ
docker pull ä½ çš„ç”¨æˆ·å/erp-platform

# è¿è¡Œ
docker run -d -p 8000:8000 --name erp --restart always ä½ çš„ç”¨æˆ·å/erp-platform
```

---

## ğŸ« æ–¹æ¡ˆå››ï¼šå­¦æ ¡å†…ç½‘æœåŠ¡å™¨

å¦‚æœåªéœ€è¦åœ¨æ ¡å†…è®¿é—®ï¼Œå¯ä»¥éƒ¨ç½²åˆ°å­¦æ ¡çš„å†…ç½‘æœåŠ¡å™¨ï¼š

1. å°†ä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨
2. ä½¿ç”¨ Gunicorn å¯åŠ¨ï¼ˆå‚è€ƒæ–¹æ¡ˆäºŒï¼‰
3. é…ç½®å†…ç½‘ IP è®¿é—®
4. å­¦ç”Ÿé€šè¿‡å†…ç½‘ IP è®¿é—®ï¼š`http://192.168.x.x:8000`

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. ä¿®æ”¹é»˜è®¤å¯†ç 

éƒ¨ç½²åï¼Œå»ºè®®ä¿®æ”¹é»˜è®¤è´¦å·å¯†ç ï¼š
- ç™»å½•ç³»ç»Ÿåï¼Œé€šè¿‡æ•°æ®åº“æˆ–ä»£ç ä¿®æ”¹ `admin` å’Œ `test` è´¦å·çš„å¯†ç 

### 2. ä½¿ç”¨ HTTPS

- **å…è´¹ SSL è¯ä¹¦**ï¼šLet's Encryptï¼ˆä½¿ç”¨ certbotï¼‰
- **äº‘å¹³å°**ï¼šRenderã€Railway ç­‰è‡ªåŠ¨æä¾› HTTPS

### 3. é™åˆ¶è®¿é—®ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦é™åˆ¶åªæœ‰ç‰¹å®š IP è®¿é—®ï¼Œå¯ä»¥åœ¨ Nginx é…ç½®ä¸­æ·»åŠ ï¼š
```nginx
allow 192.168.1.0/24;  # å…è®¸çš„ IP æ®µ
deny all;
```

---

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²ä¸Šä¼ åˆ° Git ä»“åº“
- [ ] `wsgi.py` æ–‡ä»¶å­˜åœ¨
- [ ] `requirements.txt` åŒ…å«æ‰€æœ‰ä¾èµ–ï¼ˆåŒ…æ‹¬ gunicornï¼‰
- [ ] æ•°æ®åº“ä¼šè‡ªåŠ¨åˆ›å»ºï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
- [ ] ç«¯å£é…ç½®æ­£ç¡®
- [ ] é˜²ç«å¢™è§„åˆ™å·²è®¾ç½®
- [ ] æœåŠ¡å·²è®¾ç½®ä¸ºå¼€æœºè‡ªå¯ï¼ˆæœåŠ¡å™¨éƒ¨ç½²ï¼‰

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: éƒ¨ç½²åæ— æ³•è®¿é—®
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ç«¯å£
- æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š`systemctl status erp-platform`
- æŸ¥çœ‹æ—¥å¿—ï¼š`journalctl -u erp-platform -f`

### Q2: é™æ€æ–‡ä»¶æ— æ³•åŠ è½½
- æ£€æŸ¥ Nginx é…ç½®ä¸­çš„é™æ€æ–‡ä»¶è·¯å¾„
- ç¡®è®¤ Flask çš„ `static_folder` é…ç½®æ­£ç¡®

### Q3: æ•°æ®åº“é”™è¯¯
- ç¡®è®¤æ•°æ®åº“æ–‡ä»¶æœ‰å†™å…¥æƒé™
- æ£€æŸ¥ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³

---

## ğŸ“ æ¨èæ–¹æ¡ˆ

**å¯¹äºæ•™å­¦ç”¨é€”ï¼Œæ¨èä½¿ç”¨æ–¹æ¡ˆä¸€ï¼ˆRenderï¼‰**ï¼š
- âœ… å®Œå…¨å…è´¹
- âœ… è‡ªåŠ¨ HTTPS
- âœ… 5 åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²
- âœ… è‡ªåŠ¨é‡å¯å’Œç›‘æ§
- âœ… é€‚åˆå­¦ç”Ÿè®¿é—®

**å¦‚æœå­¦ç”Ÿæ•°é‡å¤šï¼ˆ>100ï¼‰ï¼Œå»ºè®®ä½¿ç”¨æ–¹æ¡ˆäºŒï¼ˆäº‘æœåŠ¡å™¨ï¼‰**ï¼š
- âœ… æ€§èƒ½æ›´å¥½
- âœ… å¯è‡ªå®šä¹‰é…ç½®
- âœ… æˆæœ¬å¯æ§ï¼ˆå­¦ç”Ÿä¼˜æƒ ï¼‰

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹ï¼ˆRender éƒ¨ç½²ï¼‰

1. è®¿é—® https://render.comï¼Œæ³¨å†Œè´¦å·
2. ç‚¹å‡» "New +" â†’ "Web Service"
3. è¿æ¥ GitHub ä»“åº“
4. è®¾ç½®ï¼š
   - Build Command: `pip install -r erp_platform/requirements.txt`
   - Start Command: `gunicorn -c gunicorn_config.py wsgi:app`
5. ç‚¹å‡» "Create Web Service"
6. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼Œè·å¾— URL
7. å­¦ç”Ÿè®¿é—®è¯¥ URL å³å¯ä½¿ç”¨ï¼

---

**éƒ¨ç½²å®Œæˆåï¼Œè®°å¾—å°†è®¿é—®åœ°å€åˆ†äº«ç»™å­¦ç”Ÿï¼** ğŸ‰
